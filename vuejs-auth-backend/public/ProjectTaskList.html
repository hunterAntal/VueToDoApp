<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue.js To-Do List v-5</title>
  <!-- Favicon -->
  <link rel="icon" href="icon/favicon.ico" type="image/x-icon">
  <!-- Google Font for Neo-brutalist Style -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <style>
    /* Reset some default styles */
    body, h1, ul, li, button, input, select, textarea {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* Modernize the body with brutalist styling */
    body {
      display: flex;
      justify-content: center; /* Center the app horizontally */
      align-items: center; /* Center the app vertically */
      min-height: 100vh; /* Use min-height to ensure it expands appropriately */
      margin: 20px 0;
      font-family: 'Inter', sans-serif;
      font-size: 16px;
      line-height: 1.5;
      background-color: #fafafa; /* Light gray background */
      color: #111; /* Dark text for high contrast */
    }

    /* Main container for the app */
    #app {
      background-color: #ffffff; /* White background for contrast */
      padding: 20px;
      border: 3px solid #000; /* Thick, unapologetic borders */
      border-radius: 8px;
      text-align: center;
      width: 90%; /* Extend width to occupy more horizontal space */
      max-width: 600px; /* Set max width for larger screens */
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 20px;
    }

    input, select, textarea {
      width: calc(100% - 120px); /* Use more width for input */
      padding: 10px;
      margin-bottom: 10px;
      font-size: 1rem;
      border: 3px solid #000;
      outline: none;
    }

    button {
      padding: 10px 15px;
      font-size: 1rem;
      font-weight: 700;
      background-color: #000; /* Dark button background */
      color: #fff; /* White text for high contrast */
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    button:hover {
      background-color: #333; /* Slight change for hover feedback */
    }

    ul {
      list-style-type: none; /* Remove bullet points */
      padding: 0;
      margin-top: 20px;
    }

    li {
      display: flex;
      flex-direction: column; /* Stack elements vertically */
      align-items: flex-start; /* Align items to the left */
      padding: 10px;
      margin-bottom: 10px;
      border: 3px solid #000;
      background-color: #f9f9f9; /* Light color for slight contrast */
      border-radius: 4px;
      font-weight: 400;
      cursor: pointer;
    }

    li.expanded {
      cursor: default;
    }

    .button-container {
      display: flex;
      flex-wrap: wrap; /* Allow buttons to wrap if there isn't enough space */
      gap: 10px;
      margin-top: 10px; /* Add spacing above buttons */
    }

    .due-date {
      margin-top: 10px;
      font-size: 0.9rem;
      font-style: italic;
      color: #555;
    }

    .comments {
      margin-top: 10px;
      width: 100%;
    }

    .comment {
      font-size: 0.9rem;
      margin-top: 5px;
      padding: 5px;
      border: 1px solid #000;
      border-radius: 4px;
      background-color: #eaeaea;
    }

    span {
      flex: 1; /* Take up available space */
      text-align: left;
      font-weight: 400;
      width: 100%; /* Ensure it takes up full width */
    }

    .back-button {
      margin-bottom: 20px;
      padding: 10px 20px;
      font-size: 1rem;
      font-weight: 700;
      background-color: #000; /* Dark button background */
      color: #fff; /* White text for high contrast */
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .back-button:hover {
      background-color: #333; /* Slight change for hover feedback */
    }
  </style>
</head>
<body>
  <!-- Vue Application Root -->
  <div id="app">
    <!-- Back to Organization View Button -->
    <button class="back-button" @click="goBackToOrgView">
      <span class="material-icons">arrow_back</span>
      Back to Organization View
    </button>
    
    <h1>To-Do List 5</h1>
    <input type="text" v-model="newTask" placeholder="Add a new task" @keyup.enter="addOrUpdateTask">
    <button @click="addOrUpdateTask">
      <span class="material-icons">add</span>
      Add/Update Task
    </button>
    
    <ul>
      <li v-for="(task, index) in tasks" :key="index" @click.self="toggleTaskDetails(index)" :class="{ expanded: task.isExpanded }">
        <!-- Task name and due date are always visible -->
        <div @click="toggleTaskDetails(index)">
          <span>{{ task.text }}</span>
          <div v-if="task.dueDate" class="due-date">
            Due Date: {{ task.dueDate }}
          </div>
        </div>

        <!-- Expanded task details -->
        <div v-if="task.isExpanded" @click.self="toggleTaskDetails(index)">
          <!-- Editable task input field -->
          <input type="text" v-model="tasks[index].text" @keyup.enter="addOrUpdateTask">

          <!-- Display priority if available -->
          <div v-if="task.priority" class="priority-level">
            Priority: {{ task.priority }}
          </div>

          <!-- Buttons are placed below the task name -->
          <div class="button-container">
            <button @click.stop="toggleComplete(index)">
              <span class="material-icons">check_circle</span>
              Toggle Complete
            </button>
            <button @click.stop="deleteTask(index)">
              <span class="material-icons">delete</span>
              Delete
            </button>
            <button @click.stop="setDueDate(index)">
              <span class="material-icons">event</span>
              Set Due Date
            </button>
            <button @click.stop="changePriority(index)">
              <span class="material-icons">flag</span>
              Change Priority
            </button>
          </div>

          <!-- Hidden date input for picking a due date -->
          <input v-show="task.showDatePicker" type="date" @change="updateDueDate($event, index)">

          <!-- Comments section -->
          <div class="comments">
            <h3>Comments:</h3>
            <div v-for="(comment, cIndex) in task.comments" :key="cIndex" class="comment">
              {{ comment }}
            </div>
            <textarea v-model="task.newComment" placeholder="Add a comment"></textarea>
            <button @click.stop="addComment(index)">
              <span class="material-icons">comment</span>
              Add Comment
            </button>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <script>
    // Vue instance to control the to-do list application
    new Vue({
      el: '#app', // Binds Vue instance to the #app div in HTML
      data: {
        // Holds the new task being added
        newTask: '',
        // Array of tasks, each with text, completed status, priority, due date, and comments
        tasks: [
          { text: 'Hello Kam and Jamie', completed: false, dueDate: null, showDatePicker: false, priority: 'Medium', comments: [], newComment: '', isExpanded: false },
          { text: 'This is made with Vue.js', completed: false, dueDate: null, showDatePicker: false, priority: 'Low', comments: [], newComment: '', isExpanded: false },
          { text: 'First Web App', completed: false, dueDate: null, showDatePicker: false, priority: 'High', comments: [], newComment: '', isExpanded: false }
        ]
      },
      methods: {
        // Method to add a new task or update an existing one
        addOrUpdateTask() {
          // Only add if the task text is not empty after trimming spaces
          if (this.newTask.trim() !== '') {
            // Push new task to the tasks array, mark as not completed
            this.tasks.push({ text: this.newTask.trim(), completed: false, dueDate: null, showDatePicker: false, priority: 'Medium', comments: [], newComment: '', isExpanded: false });
            // Clear the newTask input field
            this.newTask = '';
          }
        },
        // Method to toggle the expanded state of a task
        toggleTaskDetails(index) {
          this.tasks[index].isExpanded = !this.tasks[index].isExpanded;
        },
        // Method to toggle the completed status of a task
        toggleComplete(index) {
          // Set task's completed property to the opposite of its current state
          this.tasks[index].completed = !this.tasks[index].completed;
        },
        // Method to delete a task from the list by its index
        deleteTask(index) {
          // Remove the task at the specified index from the tasks array
          this.tasks.splice(index, 1);
        },
        // Method to toggle the due date picker for a task
        setDueDate(index) {
          this.tasks[index].showDatePicker = !this.tasks[index].showDatePicker;
        },
        // Method to update the due date when selected
        updateDueDate(event, index) {
          this.tasks[index].dueDate = event.target.value;
          this.tasks[index].showDatePicker = false; // Hide date picker after selecting a date
        },
        // Method to change the priority of a task
        changePriority(index) {
          const currentPriority = this.tasks[index].priority;
          const priorities = ['Low', 'Medium', 'High'];
          const nextPriorityIndex = (priorities.indexOf(currentPriority) + 1) % priorities.length;
          this.tasks[index].priority = priorities[nextPriorityIndex];
        },
        // Method to add a comment to a task
        addComment(index) {
          if (this.tasks[index].newComment.trim() !== '') {
            this.tasks[index].comments.push(this.tasks[index].newComment.trim());
            this.tasks[index].newComment = '';
          }
        },
        // Method to go back to the organization view
        goBackToOrgView() {
          window.location.href = 'dashboard.html';
        }
      }
    });
  </script>
</body>
</html>